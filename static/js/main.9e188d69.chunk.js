(this["webpackJsonpsd-0x-project-trybewallet"]=this["webpackJsonpsd-0x-project-trybewallet"]||[]).push([[0],{144:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(25),i=n.n(c),l=n(27),u=(n(59),n(17)),s=n(3),o=n(20),d=n(11),p=n(12),m=n(9),h=n(14),E=n(13),v=n(51),b=n.n(v),f=n(15),x=n.n(f),y=n(21),j=function(){var e=Object(y.a)(x.a.mark((function e(){var t,n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://economia.awesomeapi.com.br/json/all",e.next=3,fetch("https://economia.awesomeapi.com.br/json/all");case 3:return t=e.sent,e.next=6,t.json();case 6:return n=e.sent,e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(e){return{type:"SUM_EXPENSES",expensesSum:e}};var g=function(e){Object(h.a)(n,e);var t=Object(E.a)(n);function n(){var e;return Object(d.a)(this,n),(e=t.call(this)).state={email:"",password:"",shouldRedirect:!1},e.handleChange=e.handleChange.bind(Object(m.a)(e)),e.isEmailValid=e.isEmailValid.bind(Object(m.a)(e)),e.isPasswordValid=e.isPasswordValid.bind(Object(m.a)(e)),e}return Object(p.a)(n,[{key:"handleChange",value:function(e){var t=e.target;this.setState(Object(o.a)({},t.name,t.value))}},{key:"handleClick",value:function(e,t){e(t),this.setState({shouldRedirect:!0})}},{key:"isEmailValid",value:function(){var e=this.state.email;return b.a.isEmail(e)}},{key:"isPasswordValid",value:function(){return this.state.password.length>=6}},{key:"render",value:function(){var e=this,t=this.state,n=t.email,a=t.password,c=t.shouldRedirect,i=this.props.registerEmail;return r.a.createElement("div",{id:"login"},r.a.createElement("form",null,r.a.createElement("fieldset",null,r.a.createElement("label",{htmlFor:"email"},"Email:",r.a.createElement("br",null),r.a.createElement("input",{name:"email",value:n,type:"email",id:"email","data-testid":"email-input",onChange:this.handleChange})),r.a.createElement("label",{htmlFor:"password"},"Senha:",r.a.createElement("br",null),r.a.createElement("input",{name:"password",value:a,type:"password","data-testid":"password-input",onChange:this.handleChange})),r.a.createElement("button",{type:"button",disabled:!this.isEmailValid()||!this.isPasswordValid(),onClick:function(){e.handleClick(i,n)}},"Entrar"))),c?r.a.createElement(s.a,{to:"/carteira"}):null)}}]),n}(r.a.Component),C=Object(u.b)(null,(function(e){return{registerEmail:function(t){return e(function(e){return{type:"REGISTER_EMAIL",email:e}}(t))}}}))(g),k=n(5),w=n(18),S=function(e){Object(h.a)(n,e);var t=Object(E.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=this.props,t=e.email,n=e.expensesSum;return r.a.createElement("div",{id:"wallet-header"},r.a.createElement("div",{id:"trybe-logo"},"Trybe Wallet"),r.a.createElement("div",{id:"user-info"},r.a.createElement("span",{"data-testid":"email-field"},"Email: ".concat(t)),r.a.createElement("span",null,"Despesa total:",r.a.createElement("span",{"data-testid":"total-field"}," R$ ".concat(n?n.toFixed(2):0)),r.a.createElement("span",{"data-testid":"header-currency-field"},"BRL"))))}}]),n}(r.a.Component),R=function(e){Object(h.a)(n,e);var t=Object(E.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"valueInput",value:function(e){var t=this.props.value;return r.a.createElement("label",{htmlFor:"value"},"Valor:",r.a.createElement("input",{onChange:e,type:"number",min:0,step:1,"data-testid":"value-input",name:"value",id:"value",value:t}))}},{key:"decriptionInput",value:function(e){var t=this.props.description;return r.a.createElement("label",{htmlFor:"description"},"Descri\xe7\xe3o:",r.a.createElement("input",{onChange:e,type:"text","data-testid":"description-input",name:"description",id:"description",placeholder:"Digite aqui a decri\xe7\xe3o do gasto",value:t}))}},{key:"currencyInput",value:function(e,t){var n=this.props.currency;return r.a.createElement("label",{htmlFor:"currency"},"Moeda:",r.a.createElement("select",{onChange:t,value:n,"data-testid":"currency-input",name:"currency",id:"currency"},e.map((function(e){return r.a.createElement("option",{"data-testid":e,key:e,value:e},e)}))))}},{key:"methodInput",value:function(e){var t=this.props.method;return r.a.createElement("label",{htmlFor:"method"},"Forma de pagamento:",r.a.createElement("select",{onChange:e,value:t,"data-testid":"method-input",name:"method",id:"method"},r.a.createElement("option",{value:"Dinheiro"},"Dinheiro"),r.a.createElement("option",{value:"Cart\xe3o de cr\xe9dito"},"Cart\xe3o de cr\xe9dito"),r.a.createElement("option",{value:"Cart\xe3o de d\xe9bito"},"Cart\xe3o de d\xe9bito")))}},{key:"tagInput",value:function(e){var t=this.props.tag;return r.a.createElement("label",{htmlFor:"tag"},"Tag:",r.a.createElement("select",{onChange:e,value:t,"data-testid":"tag-input",name:"tag",id:"tag"},r.a.createElement("option",{value:"Alimenta\xe7\xe3o"},"Alimenta\xe7\xe3o"),r.a.createElement("option",{value:"Lazer"},"Lazer"),r.a.createElement("option",{value:"Trabalho"},"Trabalho"),r.a.createElement("option",{value:"Transporte"},"Transporte"),r.a.createElement("option",{value:"Sa\xfade"},"Sa\xfade")))}},{key:"addExpenseButton",value:function(e){return r.a.createElement("button",{type:"button",onClick:e},"Adicionar despesa")}},{key:"render",value:function(){var e=this.props,t=e.handleClick,n=e.currencies,a=e.handleChange;return r.a.createElement("form",{action:""},this.valueInput(a),this.decriptionInput(a),this.currencyInput(n,a),this.methodInput(a),this.tagInput(a),this.addExpenseButton(t))}}]),n}(r.a.Component),D=function(e){Object(h.a)(n,e);var t=Object(E.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).handleDeleteClick=a.handleDeleteClick.bind(Object(m.a)(a)),a}return Object(p.a)(n,[{key:"componentDidUpdate",value:function(){this.updateExpensesSum()}},{key:"updateExpensesSum",value:function(){var e=this.props;(0,e.sumExpenses)(e.expenses.map((function(e){var t=e.currency,n=Object.entries(e.exchangeRates).find((function(e){return e[0]===t}))[1].ask,a=parseInt(e.value,10)*n;return parseFloat(a.toFixed(2))})).reduce((function(e,t){return e+t}),0))}},{key:"handleDeleteClick",value:function(e,t){t(e)}},{key:"createTableRow",value:function(e,t){var n=this;return e.map((function(e){var a=e.currency,c=Object.entries(e.exchangeRates).find((function(e){return e[0]===a}))[1].ask,i=Object.entries(e.exchangeRates).find((function(e){return e[0]===a}))[1].name,l=parseFloat((parseInt(e.value,10)*c).toFixed(2));return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,e.description),r.a.createElement("td",null,e.tag),r.a.createElement("td",null,e.method),r.a.createElement("td",null,e.value),r.a.createElement("td",null,i),r.a.createElement("td",null,parseFloat(c).toFixed(2)),r.a.createElement("td",null,parseFloat(l).toFixed(2)),r.a.createElement("td",null,"Real"),r.a.createElement("td",null,r.a.createElement("button",{type:"button"},"Editar"),r.a.createElement("button",{type:"button","data-testid":"delete-btn",onClick:function(){return n.handleDeleteClick(e.id,t)}},"Excluir")))}))}},{key:"render",value:function(){var e=this.props,t=e.expenses,n=e.deleteRow;return r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Descri\xe7\xe3o"),r.a.createElement("th",null,"Tag"),r.a.createElement("th",null,"M\xe9todo de pagamento"),r.a.createElement("th",null,"Valor"),r.a.createElement("th",null,"Moeda"),r.a.createElement("th",null,"C\xe2mbio utilizado"),r.a.createElement("th",null,"Valor convertido"),r.a.createElement("th",null,"Moeda de convers\xe3o"),r.a.createElement("th",null,"Editar/Excluir"))),r.a.createElement("tbody",null,this.createTableRow(t,n)))}}]),n}(r.a.Component),I=Object(u.b)((function(e){return{expenses:e.wallet.expenses}}),(function(e){return{deleteRow:function(t){return e(function(e){return{type:"DELETE_ROW",expenseId:e}}(t))},sumExpenses:function(t){return e(O(t))}}}))(D),F=function(e){Object(h.a)(n,e);var t=Object(E.a)(n);function n(){var e;return Object(d.a)(this,n),(e=t.call(this)).state={currencies:[],currentExpense:{id:0,currency:"USD",method:"Dinheiro",tag:"Alimenta\xe7\xe3o",value:0,description:""}},e.handleChange=e.handleChange.bind(Object(m.a)(e)),e.handleClick=e.handleClick.bind(Object(m.a)(e)),e.sumExpenses=e.sumExpenses.bind(Object(m.a)(e)),e}return Object(p.a)(n,[{key:"componentDidMount",value:function(){this.sendCurrenciesKeysToState()}},{key:"fetchCurrencies",value:function(){var e=Object(y.a)(x.a.mark((function e(){var t,n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://economia.awesomeapi.com.br/json/all");case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"sendCurrenciesKeysToState",value:function(){var e=Object(y.a)(x.a.mark((function e(){var t,n,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchCurrencies();case 2:t=e.sent,n=Object.keys(t),a=n.indexOf("USDT"),this.setState({currencies:[].concat(Object(w.a)(n.slice(0,a)),Object(w.a)(n.slice(a+1,t.length)))});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleChange",value:function(e){var t=e.target,n=this.state.currentExpense;this.setState({currentExpense:Object(k.a)(Object(k.a)({},n),{},Object(o.a)({},t.name,t.value))})}},{key:"sumExpenses",value:function(){var e=this.props,t=e.expenses,n=e.sumExpenses;n(t.map((function(e){var t=e.currency,n=Object.entries(e.exchangeRates).find((function(e){return e[0]===t}))[1].ask,a=parseInt(e.value,10)*n;return parseFloat(a.toFixed(2))})).reduce((function(e,t){return e+t}),0))}},{key:"handleClick",value:function(){var e=Object(y.a)(x.a.mark((function e(t,n){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(t);case 2:this.sumExpenses(),this.setState((function(e){return{currentExpense:{id:e.currentExpense.id+1,currency:"USD",method:"Dinheiro",tag:"Alimenta\xe7\xe3o",value:0,description:""}}}));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,n=t.currencies,a=t.currentExpense,c=a.currency,i=a.description,l=a.method,u=a.tag,s=a.value,o=this.props,d=o.email,p=o.getUpdatedCurrencies,m=o.expensesSum;return r.a.createElement("div",null,r.a.createElement("header",null,r.a.createElement(S,{email:d,expensesSum:m})),r.a.createElement("main",null,r.a.createElement("section",{id:"inputs-section"},r.a.createElement(R,{handleChange:this.handleChange,currencies:n,handleClick:function(){return e.handleClick(a,p)},currency:c,description:i,method:l,tag:u,value:s})),r.a.createElement("section",{id:"table-section"},r.a.createElement(I,{expensesSum:m}))))}}]),n}(r.a.Component),T=Object(u.b)((function(e){return{email:e.user.email,expenses:e.wallet.expenses,expensesSum:e.wallet.expensesSum}}),(function(e){return{getUpdatedCurrencies:function(t){return e((n=t,function(e){return j().then((function(t){e(function(e){return{type:"RECEIVE_CURRENCIES",data:e}}(t)),e(function(e,t){return{type:"ADD_EXPENSE",expense:e,data:t}}(n,t))}))}));var n},sumExpenses:function(t){return e(O(t))}}}))(F);var V=function(){return r.a.createElement(s.d,null,r.a.createElement(s.b,{exact:!0,path:"/",component:C}),r.a.createElement(s.b,{path:"/carteira",component:T}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var M=n(16),U=n(52),_=n(53),A={email:""},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REGISTER_EMAIL":return{email:t.email};default:return e}},L={currencies:[],expenses:[],expensesSum:0},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,t=arguments.length>1?arguments[1]:void 0,n=Object(k.a)(Object(k.a)({},t.expense),{},{exchangeRates:t.data}),a=e.expenses.indexOf(e.expenses.find((function(e){return e.id===t.expenseId})));switch(t.type){case"ADD_EXPENSE":return Object(k.a)(Object(k.a)({},e),{},{expenses:[].concat(Object(w.a)(e.expenses),[n])});case"RECEIVE_CURRENCIES":return Object(k.a)(Object(k.a)({},e),{},{currencies:t.data});case"DELETE_ROW":return Object(k.a)(Object(k.a)({},e),{},{expenses:[].concat(Object(w.a)(e.expenses.slice(0,a)),Object(w.a)(e.expenses.slice(a+1,e.expenses.length)))});case"SUM_EXPENSES":return Object(k.a)(Object(k.a)({},e),{},{expensesSum:t.expensesSum});default:return e}},W=Object(M.combineReducers)({user:P,wallet:N}),B=Object(M.createStore)(W,Object(U.composeWithDevTools)(Object(M.applyMiddleware)(_.a)));i.a.render(r.a.createElement(u.a,{store:B},r.a.createElement(l.a,null,r.a.createElement(V,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},54:function(e,t,n){e.exports=n(144)},59:function(e,t,n){}},[[54,1,2]]]);
//# sourceMappingURL=main.9e188d69.chunk.js.map